<%- include('../partials/header') %>

<main class="container details-main">
  <div class="details-wrapper">
    <div class="poster-container">
      <img
        src="https://image.tmdb.org/t/p/original<%= show.poster_path %>"
        alt="<%= show.name %> poster"
        class="poster-img"
      />
    </div>
    <div class="details-content">
      <h1 class="title"><%= show.name %></h1>
      <div class="tagline"><%= show.tagline %></div>
      <div class="overview"><%= show.overview %></div>

      <div class="genres">
        <span class="label">Genres:</span>
        <% show.genres.forEach(function(genre) { %>
        <span class="genre-tag"><%= genre.name %></span>
        <% }); %>
      </div>

      <div class="extra-info">
        <span class="label">Total Episodes:</span>
        <span class="info-value"><%= show.number_of_episodes %></span>
        <span class="label">Total Seasons:</span>
        <span class="info-value"><%= show.number_of_seasons %></span>
      </div>
    </div>
  </div>

  <div class="seasons-section">
    <h2 class="subtitle">Seasons</h2>
    <ul class="season-list">
      <% show.seasons.forEach(function(season, idx) { %>
      <li class="season-item">
        <button
          type="button"
          onclick="toggleDropdown('season-<%= idx %>')"
          class="season-btn"
        >
          <img
            src="https://image.tmdb.org/t/p/w92<%= season.poster_path %>"
            alt="Season <%= season.season_number %> poster"
            class="season-poster"
          />
          <span class="season-title">
            <%= season.name %>
            <span class="season-number"
              >(Season <%= season.season_number %>)</span
            >
          </span>
          <span class="episode-badge"
            ><%= season.episode_count %> Episodes</span
          >
        </button>

        <div id="season-<%= idx %>" class="season-dropdown">
          <div class="season-overview"><%= season.overview %></div>
          <% if (season.episode_count > 0) { %>
          <ul class="episode-list">
            <% for (var i = 1; i <= season.episode_count; i++) { %>
            <li class="episode-item">
              <span class="episode-badge">Episode <%= i %></span>
              <a
                href="/tvshows/<%= show.id %>/season/<%= season.season_number %>/episode/<%= i %>"
                class="watch-link"
                >Watch</a
              >
            </li>
            <% } %>
          </ul>
          <% } else { %>
          <div class="no-episodes">No episode data available.</div>
          <% } %>
        </div>
      </li>
      <% }); %>
    </ul>
  </div>
</main>

<script src="/js/dropdown.js"></script>

<%- include('../partials/footer') %>
