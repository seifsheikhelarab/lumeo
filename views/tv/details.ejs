<%- include('../partials/header') %>

<main class="container" style="align-items: stretch">
  <div
    style="
      display: flex;
      flex-wrap: wrap;
      gap: 2.5rem;
      justify-content: center;
      align-items: flex-start;
      max-width: 900px;
      margin: 2rem auto;
    "
  >
    <div style="flex: 0 0 260px">
      <img
        src="https://image.tmdb.org/t/p/original<%= show.poster_path %>"
        alt="<%= show.name %> poster"
        style="
          width: 100%;
          max-width: 260px;
          border-radius: 16px;
          box-shadow: 0 2px 12px rgba(0, 0, 0, 0.25);
        "
      />
    </div>
    <div style="flex: 1; min-width: 260px">
      <h1 style="color: #fbbf24; font-size: 2.2rem; margin-bottom: 0.7rem">
        <%= show.name %>
      </h1>
      <div
        style="
          font-size: 1.1rem;
          color: #a3a3a3;
          font-style: italic;
          margin-bottom: 1.2rem;
        "
      >
        <%= show.tagline %>
      </div>
      <div style="margin-bottom: 1.5rem; color: #e5e7eb; font-size: 1.08rem">
        <%= show.overview %>
      </div>
      <div style="margin-bottom: 1.5rem">
        <span style="font-weight: 600; color: #fbbf24">Genres:</span>
        <% show.genres.forEach(function(genre, idx) { %>
        <span
          style="
            background: #29292f;
            color: #e5e7eb;
            border-radius: 8px;
            padding: 0.3rem 0.9rem;
            margin-right: 0.7rem;
            font-size: 0.98rem;
          "
        >
          <%= genre.name %>
        </span>
        <% }); %>
      </div>
      <div style="margin-bottom: 1.5rem">
        <span style="font-weight: 600; color: #fbbf24">Total Episodes:</span>
        <span style="color: #e5e7eb; margin-right: 1.5rem"
          ><%= show.number_of_episodes %></span
        >
        <span style="font-weight: 600; color: #fbbf24">Total Seasons:</span>
        <span style="color: #e5e7eb"><%= show.number_of_seasons %></span>
      </div>
    </div>
  </div>
  <div style="max-width: 900px; margin: 2rem auto">
    <h2 style="color: #fbbf24; margin-bottom: 1.2rem">Seasons</h2>
    <ul style="list-style: none; padding: 0; width: 50rem;">
      <% show.seasons.forEach(function(season, idx) { %>
      <li style="margin-bottom: 1.5rem">
        <button
          type="button"
          onclick="toggleDropdown('season-<%= idx %>')"
          style="
            width: 100%;
            background: linear-gradient(90deg, #23232a 60%, #29292f 100%);
            color: #fbbf24;
            font-size: 1.15rem;
            font-weight: 700;
            border: none;
            border-radius: 14px;
            padding: 1.1rem 1.2rem;
            text-align: left;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.18);
            display: flex;
            align-items: center;
            transition: background 0.2s;
          "
          onmouseover="this.style.background='linear-gradient(90deg, #29292f 60%, #23232a 100%)'"
          onmouseout="this.style.background='linear-gradient(90deg, #23232a 60%, #29292f 100%)'"
        >
          <img
            src="https://image.tmdb.org/t/p/w92<%= season.poster_path %>"
            alt="Season <%= season.season_number %> poster"
            style="
              border-radius: 10px;
              margin-right: 1.2rem;
              width: 52px;
              height: 78px;
              object-fit: cover;
              box-shadow: 0 1px 6px rgba(0, 0, 0, 0.15);
            "
          />
          <span style="flex: 1">
            <%= season.name %>
            <span style="color: #e5e7eb; font-size: 1rem"
              >(Season <%= season.season_number %>)</span
            >
          </span>
          <span
            style="
              background: #29292f;
              color: #fbbf24;
              border-radius: 8px;
              padding: 0.3rem 0.9rem;
              font-size: 0.98rem;
              margin-left: 1rem;
            "
          >
            <%= season.episode_count %> Episodes
          </span>
        </button>
        <div
          id="season-<%= idx %>"
          class="season-dropdown"
          style="
            display: none;
            background: #23232a;
            border-radius: 0 0 14px 14px;
            padding: 1.2rem 2rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);
          "
        >
          <div
            style="
              color: #a3a3a3;
              font-size: 1.05rem;
              margin-bottom: 1rem;
              font-style: italic;
            "
          >
            <%= season.overview %>
          </div>
          <% if (season.episode_count > 0) { %>
          <ul style="list-style: none; padding: 0">
            <% for (var i = 1; i <= season.episode_count; i++) { %>
            <li
              style="margin-bottom: 0.7rem; display: flex; align-items: center"
            >
              <span
                style="
                  background: #29292f;
                  color: #fbbf24;
                  border-radius: 6px;
                  padding: 0.2rem 0.7rem;
                  font-size: 0.97rem;
                  margin-right: 0.7rem;
                  min-width: 90px;
                  text-align: center;
                "
                >Episode <%= i %></span
              >
              <a
                href="/tvshows/<%= show.id %>/season/<%= season.season_number %>/episode/<%= i %>"
                style="
                  color: #e5e7eb;
                  text-decoration: none;
                  font-weight: 600;
                  font-size: 1.01rem;
                "
                >Watch</a
              >
            </li>
            <% } %>
          </ul>
          <% } else { %>
          <div style="color: #a3a3a3">No episode data available.</div>
          <% } %>
        </div>
      </li>
      <% }); %>
    </ul>
  </div>
</main>

<script>
  function toggleDropdown(id) {
    var el = document.getElementById(id);
    el.style.display = el.style.display === "none" ? "block" : "none";
  }
</script>

<%- include('../partials/footer') %>
